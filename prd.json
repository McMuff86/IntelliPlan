{
  "name": "Task Planning & Project Scheduling",
  "branchName": "feature/task-planning",
  "description": "Extend IntelliPlan with project-based task planning, dependent tasks, manual work slots, optional reminders, and cascading schedule shifts.",
  "userStories": [
    {
      "id": "US-TP-001",
      "title": "Database schema for projects and tasks",
      "description": "As a developer, I want tables for projects, tasks, dependencies, and work slots so tasks can be planned and linked over weeks or months.",
      "acceptanceCriteria": [
        "projects table with owner, calendar template (weekends, working hours)",
        "tasks table with status, duration, and planned range fields",
        "task_dependencies table with dependency type",
        "task_work_slots table for manual time blocks"
      ],
      "technicalNotes": "Store timestamps in UTC, return ISO 8601. Add CHECK constraints for status and dependency types.",
      "dependencies": [],
      "priority": 1,
      "passes": true
    },
    {
      "id": "US-TP-002",
      "title": "Project CRUD API",
      "description": "As a user, I want to create, read, update, and delete projects so I can group tasks.",
      "acceptanceCriteria": [
        "POST /api/projects",
        "GET /api/projects",
        "GET /api/projects/:id",
        "PUT /api/projects/:id",
        "DELETE /api/projects/:id"
      ],
      "technicalNotes": "",
      "dependencies": ["US-TP-001"],
      "priority": 2,
      "passes": true
    },
    {
      "id": "US-TP-003",
      "title": "Task CRUD API",
      "description": "As a user, I want to manage tasks within projects so I can plan work packages.",
      "acceptanceCriteria": [
        "POST /api/projects/:projectId/tasks",
        "GET /api/projects/:projectId/tasks",
        "GET /api/tasks/:id",
        "PUT /api/tasks/:id",
        "DELETE /api/tasks/:id"
      ],
      "technicalNotes": "",
      "dependencies": ["US-TP-001", "US-TP-002"],
      "priority": 3,
      "passes": true
    },
    {
      "id": "US-TP-004",
      "title": "Work slots (manual planning)",
      "description": "As a user, I want to define work slots for tasks so I can distribute work across days and weeks.",
      "acceptanceCriteria": [
        "POST /api/tasks/:id/work-slots",
        "GET /api/tasks/:id/work-slots",
        "DELETE /api/tasks/:id/work-slots/:slotId",
        "Validation: end time is after start time"
      ],
      "technicalNotes": "",
      "dependencies": ["US-TP-003"],
      "priority": 4,
      "passes": true
    },
    {
      "id": "US-TP-005",
      "title": "Manage task dependencies",
      "description": "As a user, I want to define task dependencies so I can control sequencing and blocking.",
      "acceptanceCriteria": [
        "Dependency types: start-start, finish-finish, finish-start",
        "POST /api/tasks/:id/dependencies",
        "GET /api/tasks/:id/dependencies",
        "DELETE /api/tasks/:id/dependencies/:dependencyId"
      ],
      "technicalNotes": "",
      "dependencies": ["US-TP-003"],
      "priority": 5,
      "passes": true
    },
    {
      "id": "US-TP-006",
      "title": "Blocked status and validation",
      "description": "As a user, I want to see blocking status so I do not start tasks with unmet dependencies.",
      "acceptanceCriteria": [
        "Task shows blocked when dependencies are not satisfied",
        "Start action is only possible when dependencies are fulfilled"
      ],
      "technicalNotes": "",
      "dependencies": ["US-TP-005"],
      "priority": 6,
      "passes": true
    },
    {
      "id": "US-TP-007",
      "title": "Shift and cascade scheduling",
      "description": "As a user, I want to shift tasks and auto-adjust dependent tasks so the plan stays consistent.",
      "acceptanceCriteria": [
        "Default: shifting only pulls dependent follow-up tasks",
        "Option to move the whole task block, not just follow-ups",
        "Cascading respects dependency types"
      ],
      "technicalNotes": "Phase 1 can be basic; Phase 2 should differentiate dependency types.",
      "dependencies": ["US-TP-004", "US-TP-005"],
      "priority": 7,
      "passes": true
    },
    {
      "id": "US-TP-008",
      "title": "UI: Project and task overview",
      "description": "As a user, I want to see projects and tasks in an overview so I can navigate quickly.",
      "acceptanceCriteria": [
        "Project list with task list per project",
        "Status, duration, and blocked state are visible",
        "Verify in browser using dev-browser skill"
      ],
      "technicalNotes": "",
      "dependencies": ["US-TP-002", "US-TP-003"],
      "priority": 8,
      "passes": true
    },
    {
      "id": "US-TP-009",
      "title": "UI: Task detail and work slots",
      "description": "As a user, I want a task detail view with slots so I can add and remove time blocks.",
      "acceptanceCriteria": [
        "Slot list with times",
        "Add and remove UI for slots",
        "Dependencies visible",
        "Verify in browser using dev-browser skill"
      ],
      "technicalNotes": "",
      "dependencies": ["US-TP-003", "US-TP-004", "US-TP-005"],
      "priority": 9,
      "passes": true
    },
    {
      "id": "US-TP-010",
      "title": "UI: Timeline/Gantt view",
      "description": "As a user, I want a timeline view so I can plan durations and dependencies visually.",
      "acceptanceCriteria": [
        "Gantt or timeline view per project",
        "Dependencies shown with lines or indicators",
        "Verify in browser using dev-browser skill"
      ],
      "technicalNotes": "",
      "dependencies": ["US-TP-008"],
      "priority": 10,
      "passes": true
    },
    {
      "id": "US-TP-011",
      "title": "Calendar reminders (optional)",
      "description": "As a user, I want optional reminders so tasks show up in the calendar.",
      "acceptanceCriteria": [
        "Toggle per work slot or task",
        "Reminder-only, no hard appointment binding",
        "Verify in browser using dev-browser skill"
      ],
      "technicalNotes": "",
      "dependencies": ["US-TP-004"],
      "priority": 11,
      "passes": true
    },
    {
      "id": "US-TP-012",
      "title": "Working time templates",
      "description": "As a user, I want working time templates so I can plan faster.",
      "acceptanceCriteria": [
        "Templates for Mon-Fri 8-17 with optional weekends",
        "Templates can be saved per project",
        "Verify in browser using dev-browser skill"
      ],
      "technicalNotes": "",
      "dependencies": ["US-TP-002"],
      "priority": 12,
      "passes": false
    },
    {
      "id": "US-015",
      "title": "Enhance Beads Integration for Better Memory Management",
      "description": "As a developer, I want automatic deduplication and summarization in progress.txt so that the Ralph loop maintains efficient memory across iterations.",
      "acceptanceCriteria": [
        "Python script runs on iteration end to deduplicate progress.txt",
        "Reduces progress.txt size by 20% through summarization",
        "Beads (prd.json, progress.txt) are versioned with timestamps",
        "bead-check function in ralph.sh validates JSON integrity",
        "No errors on invalid beads",
        "Update AGENTS.md with new patterns"
      ],
      "technicalNotes": "Reference Steve Yegge's Beads for file-based persistence. Run Python script via Node exec. Ensure backward compatibility.",
      "dependencies": [],
      "priority": 13,
      "passes": true
    },
    {
      "id": "US-016",
      "title": "Add AI-Powered Conflict Resolution in Scheduling",
      "description": "As a user, I want AI-powered conflict resolution so that overlapping appointments can be automatically rescheduled based on priority and preferences.",
      "acceptanceCriteria": [
        "Integrate ML model (Hugging Face API or local torch) into appointmentService.ts",
        "Predict and suggest resolutions for overlaps",
        "On 409 conflict, API returns AI suggestions",
        "Store historical conflict learnings in beads",
        "Test with 5 overlapping appointments",
        "Log learnings to progress.txt"
      ],
      "technicalNotes": "Use Hugging Face API for MVP. Consider common patterns in Schreinerei scenarios (carpentry shops). Keep model lightweight for fast responses.",
      "dependencies": [],
      "priority": 14,
      "passes": true
    },
    {
      "id": "US-017",
      "title": "Implement Reverse-Planning Feature for Carpentry Use Case",
      "description": "As a carpentry shop manager, I want reverse-planning from end-date and resources so that I can optimize my schedule based on project deadlines and machine availability.",
      "acceptanceCriteria": [
        "Add endpoint POST /api/appointments/reverse-plan in appointmentController.ts",
        "Input: end-date, resources, tasks list",
        "Output: optimized schedule working backwards",
        "Use greedy algorithm with date-fns",
        "Enhanced by AI prompts via beads-stored templates",
        "Frontend: Add 'Optimize Schedule' button in CalendarView",
        "Handles 10 tasks minimum",
        "Outputs conflict-free plan",
        "Demo with ERP-like data (machine availability)",
        "Update prd.json status on completion"
      ],
      "technicalNotes": "Reverse planning works backward from deadline. Consider resource constraints, working hours, dependencies. Integrate with existing appointment overlap detection.",
      "dependencies": ["US-TP-001"],
      "priority": 15,
      "passes": false
    },
    {
      "id": "US-018",
      "title": "Add Authentication and DSGVO Compliance Basics",
      "description": "As a user, I want secure authentication and data protection so that my scheduling data is safe and compliant with Swiss/EU regulations.",
      "acceptanceCriteria": [
        "Integrate Supabase Auth in frontend (App.tsx)",
        "Add requireUserId middleware in backend",
        "Soft data encryption for beads containing user data",
        "Timezone handling complies with CH regulations",
        "User login/logout works correctly",
        "No data leaks in tests",
        "Encrypted beads for sensitive data"
      ],
      "technicalNotes": "DSGVO (GDPR in German) compliance requires: consent management, data encryption at rest, right to deletion. Use bcryptjs for passwords, ensure all timestamps use ISO 8601 with timezone.",
      "dependencies": [],
      "priority": 16,
      "passes": false
    },
    {
      "id": "US-019",
      "title": "Create Inbound Marketing Hook",
      "description": "As a business owner, I want a demo page and shareable materials so that I can attract potential carpentry shop clients via LinkedIn and X.",
      "acceptanceCriteria": [
        "Build /demo route in frontend",
        "Demo page shows scheduling features",
        "Generate shareable PDF export using jsPDF",
        "PDF includes outcomes (e.g., 'Saved 15 hours')",
        "Update README.md with business pitch",
        "Page renders demo calendar",
        "Log deployment learnings to beads",
        "Include call-to-action for 50-200 CHF/user pricing"
      ],
      "technicalNotes": "Demo should showcase reverse-planning and conflict resolution. Use sample data for Swiss carpentry shop. Make it visually impressive for LinkedIn sharing.",
      "dependencies": ["US-017"],
      "priority": 17,
      "passes": false
    }
  ]
}
